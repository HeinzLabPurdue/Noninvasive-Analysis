
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>analysis_setup</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2025-03-19"><meta name="DC.source" content="analysis_setup.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Plot limits</a></li><li><a href="#3">ROOT Directory</a></li><li><a href="#4">Subjects and Conditions</a></li><li><a href="#5">Analysis Code</a></li><li><a href="#6">TBD</a></li><li><a href="#8">Analysis Summary</a></li></ul></div><pre class="codeinput">clc; close <span class="string">all</span>; clear <span class="string">all</span>;
exposure_group = <span class="string">'NOISE'</span>; <span class="comment">% 'NOISE' or 'BLAST'</span>
plot_relative_flag = 1;   <span class="comment">% Relative to Baseline:  Yes = 1   or  No = 0</span>
reanalyze = 0; <span class="comment">% 1 = redo analysis      0 = skip analysis</span>
efr_level = 65; <span class="comment">% EFR Levels = 65 or 80 dB SPL</span>
shapes = [<span class="string">"o"</span>;<span class="string">"square"</span>;<span class="string">"diamond"</span>;<span class="string">"^"</span>;<span class="string">"v"</span>;<span class="string">"&gt;"</span>;<span class="string">"pentagram"</span>];
colors = [0,114,189; 237,177,32; 126,47,142; 119,172,48; 204,0,0; 255,51,255; 217 83 25]/255;
</pre><h2 id="2">Plot limits</h2><pre class="codeinput">ylimits_avg_oae = [-60,60];
ylimits_ind_oae = [-60,60];
xlimits_memr = [70,105];
ylimits_efr = [0,1.3];
ylimits_ind_abr_threshold = [0,80];
ylimits_avg_abr_threshold = [-10,50];
ylimits_ind_abr_peaks = [0,inf];
ylimits_avg_abr_peaks = [-inf,inf];
ylimits_ind_abr_lat = [-inf,inf];
ylimits_avg_abr_lat = [-inf,inf];
</pre><h2 id="3">ROOT Directory</h2><pre class="codeinput"><span class="keyword">if</span> ismac
    <span class="comment">%ROOTdir = '/Volumes/heinz/data/UserTESTS/FA/DOD';  % data depot</span>
    ROOTdir = <span class="string">'/Volumes/FefeSSD/DOD'</span>;
<span class="keyword">else</span>
    <span class="comment">%ROOTdir = 'Z:\data\UserTESTS\FA\DOD'; % data depot</span>
    ROOTdir = <span class="string">'D:\DOD'</span>; <span class="comment">% SSD</span>
    <span class="comment">%ROOTdir = 'F:\DOD'; % NEL2</span>
<span class="keyword">end</span>
</pre><h2 id="4">Subjects and Conditions</h2><pre class="codeinput"><span class="keyword">if</span> strcmp(exposure_group,<span class="string">'BLAST'</span>)
    Conds2Run = {strcat(<span class="string">'pre'</span>,filesep,<span class="string">'Baseline'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D3'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D15'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D43'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D92'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D107'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D120'</span>)};
    Chins2Run={<span class="string">'Q493'</span>,<span class="string">'Q494'</span>};
    <span class="comment">% BLAST: 'Q457','Q463','Q478','Q493','Q494'</span>
    <span class="comment">% 75 kPa: 'Q457','Q478','Q493'</span>
    <span class="comment">% 150 kPa: 'Q463','Q494'</span>
<span class="keyword">elseif</span> strcmp(exposure_group,<span class="string">'NOISE'</span>)
    Conds2Run = {strcat(<span class="string">'pre'</span>,filesep,<span class="string">'Baseline'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D7'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D14'</span>),strcat(<span class="string">'post'</span>,filesep,<span class="string">'D30'</span>)};
    Chins2Run={<span class="string">'Q438'</span>,<span class="string">'Q445'</span>,<span class="string">'Q446'</span>,<span class="string">'Q447'</span>,<span class="string">'Q460'</span>,<span class="string">'Q461'</span>,<span class="string">'Q462'</span>,<span class="string">'Q464'</span>,<span class="string">'Q473'</span>,<span class="string">'Q474'</span>,<span class="string">'Q475'</span>,<span class="string">'Q476'</span>,<span class="string">'Q479'</span>,<span class="string">'Q480'</span>,<span class="string">'Q481'</span>,<span class="string">'Q482'</span>,<span class="string">'Q483'</span>,<span class="string">'Q484'</span>,<span class="string">'Q485'</span>,<span class="string">'Q486'</span>,<span class="string">'Q487'</span>,<span class="string">'Q488'</span>};
    <span class="comment">% ALL: 'Q438','Q445','Q446','Q447','Q460','Q461','Q462','Q464','Q473','Q474','Q475','Q476','Q479','Q480','Q481','Q482','Q483','Q484','Q485','Q486','Q487','Q488'</span>
    <span class="comment">% Group 1: 'Q438','Q445','Q446','Q447' (8hrs/5 days per week)</span>
    <span class="comment">% Group 2: 'Q460','Q461','Q462','Q464' (10hrs/4 days per week)</span>
    <span class="comment">% Group 3: 'Q473','Q474','Q475','Q476','Q479','Q480' (10hrs/4 days per week)</span>
    <span class="comment">% Group 4: 'Q481','Q482','Q483','Q484','Q487','Q488' (10hrs/4 days per week)</span>
    <span class="comment">% Group 5: 'Q485','Q486' (10hrs/4 days per week)</span>
    <span class="comment">% GROUP 6: 'Q499','Q500','Q503','Q504','Q505' (NAIVE)</span>
<span class="keyword">end</span>
<span class="keyword">if</span> plot_relative_flag == 1
    plot_relative = {strcat(<span class="string">'pre'</span>,filesep,<span class="string">'Baseline'</span>)};
<span class="keyword">else</span>
    plot_relative = {};
<span class="keyword">end</span>
</pre><h2 id="5">Analysis Code</h2><pre class="codeinput">cwd = pwd;
<span class="keyword">if</span> ~isempty(plot_relative)
    idx_plot_relative = ismember(plot_relative,Conds2Run);
<span class="keyword">else</span>
    idx_plot_relative = [];
<span class="keyword">end</span>
[EXPname, EXPname2, EXPname3] = analysis_menu;
[DATAdir, OUTdir, CODEdir] = get_directory(ROOTdir,EXPname,EXPname2);
addpath(CODEdir);
<span class="keyword">if</span> strcmp(EXPname,<span class="string">'OAE'</span>)
    filepath_searchfile = [<span class="string">'*'</span>,EXPname2,<span class="string">'*.mat'</span>];
    datapath_searchfile = filepath_searchfile;
<span class="keyword">elseif</span> strcmp(EXPname,<span class="string">'ABR'</span>)
    datapath_searchfile = <span class="string">'*ABR*.mat'</span>;
    <span class="keyword">switch</span> EXPname2
        <span class="keyword">case</span> <span class="string">'Thresholds'</span>
            filepath_searchfile = [<span class="string">'*'</span>,EXPname,<span class="string">'thresholds*.mat'</span>];
        <span class="keyword">case</span> <span class="string">'Peaks'</span>
            <span class="keyword">switch</span> EXPname3
                <span class="keyword">case</span> <span class="string">'Manual'</span>
                    filepath_searchfile = [<span class="string">'*'</span>,EXPname,<span class="string">'peaks*.mat'</span>];
                <span class="keyword">case</span> <span class="string">'DTW'</span>
                    filepath_searchfile = [<span class="string">'*'</span>,EXPname,<span class="string">'peaks_dtw*.mat'</span>];
            <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">elseif</span> strcmp(EXPname,<span class="string">'EFR'</span>)
    filepath_searchfile = <span class="string">'*EFR*.mat'</span>;
    datapath_searchfile = <span class="string">'*FFR*.mat'</span>;
<span class="keyword">else</span>
    filepath_searchfile = [<span class="string">'*'</span>,EXPname,<span class="string">'*.mat'</span>];
    datapath_searchfile = filepath_searchfile;
<span class="keyword">end</span>
<span class="comment">% Check available subjects and conditions</span>
chinroster_file = <span class="string">'DOD_ChinRoster.xlsx'</span>;
<span class="keyword">if</span> ~isempty(search_files(OUTdir,chinroster_file).files)
    cd(OUTdir)
    chinroster_temp = readcell(chinroster_file,<span class="string">'Sheet'</span>,exposure_group);
    temp_idx = cellfun(@(x) any(isa(x,<span class="string">'missing'</span>)), chinroster_temp);
    chinroster_temp(temp_idx) = {NaN};
    [temp_rows,temp_cols] = size(chinroster_temp);
    temp = zeros(1,temp_rows);
    <span class="comment">% Define rows for subjects to include</span>
    <span class="keyword">for</span> i=1:temp_rows
        <span class="keyword">for</span> j=1:length(Chins2Run)
            <span class="keyword">if</span> strcmp(chinroster_temp(i,1),Chins2Run{j})
                temp(i) = 1;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">% Define cols for conditions to include</span>
    col_idx = zeros(1,temp_cols);
    <span class="keyword">for</span> i=1:temp_rows
        <span class="keyword">for</span> j=1:temp_cols
            <span class="keyword">if</span> strcmp(chinroster_temp(i,j),<span class="string">'Baseline'</span>) || strcmp(chinroster_temp(i,j),<span class="string">'B'</span>)
                col_idx(j) = 1;
                row_idx = i;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    col_idx = find(col_idx == 1);
    conds_length = col_idx(2)-col_idx(1)-1;
    all_temp = chinroster_temp(row_idx,col_idx(1):col_idx(1)+conds_length);
    <span class="keyword">for</span> i=1:length(all_temp)
        <span class="keyword">if</span> strcmp(all_temp{i},<span class="string">'Baseline'</span>) || strcmp(all_temp{i},<span class="string">'B'</span>)
            all_Conds2Run{i} = strcat(<span class="string">'pre'</span>,filesep,all_temp{i});
        <span class="keyword">else</span>
            all_Conds2Run{i} = strcat(<span class="string">'post'</span>,filesep,all_temp{i});
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    chins_idx = find(temp==1);
    conds_idx = zeros(size(all_Conds2Run));
    <span class="keyword">for</span> i=1:length(all_Conds2Run)
        conds_idx(i) = find(strcmp(Conds2Run(i),all_Conds2Run));
    <span class="keyword">end</span>
    Chins2Run = chinroster_temp(chins_idx,1);
    chinroster.ChinSex = chinroster_temp(chins_idx,2);
    <span class="keyword">switch</span> EXPname
        <span class="keyword">case</span> <span class="string">'ABR'</span>
            range = col_idx(1):col_idx(1)+conds_length;
            temp = chinroster_temp(:,range);
            chinroster.signal = temp(chins_idx,conds_idx);
        <span class="keyword">case</span> <span class="string">'EFR'</span>
            range = col_idx(2):col_idx(2)+conds_length;
            temp = chinroster_temp(:,range);
            chinroster.signal = temp(chins_idx,conds_idx);
        <span class="keyword">case</span> <span class="string">'OAE'</span>
            <span class="keyword">switch</span> EXPname2
                <span class="keyword">case</span> <span class="string">'DPOAE'</span>
                    range = col_idx(3):col_idx(3)+conds_length;
                    temp = chinroster_temp(:,range);
                    chinroster.signal = temp(chins_idx,conds_idx);
                <span class="keyword">case</span> <span class="string">'SFOAE'</span>
                    range = col_idx(4):col_idx(4)+conds_length;
                    temp = chinroster_temp(:,range);
                    chinroster.signal = temp(chins_idx,conds_idx);
                <span class="keyword">case</span> <span class="string">'TEOAE'</span>
                    range = col_idx(5):col_idx(5)+conds_length;
                    temp = chinroster_temp(:,range);
                    chinroster.signal = temp(chins_idx,conds_idx);
            <span class="keyword">end</span>
        <span class="keyword">case</span> <span class="string">'MEMR'</span>
            range = col_idx(6):col_idx(6)+conds_length;
            temp = chinroster_temp(:,range);
            chinroster.signal = temp(chins_idx,conds_idx);
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">% Check if RAW data has been analyzed</span>
counter = 0;
flag = 0;
chins_idx = [];
filepath_idx = zeros(length(Chins2Run),length(Conds2Run));
datapath_idx = zeros(length(Chins2Run),length(Conds2Run));
subject_idx = zeros(length(Chins2Run),length(Conds2Run));
addpath(strcat(ROOTdir,filesep,<span class="string">'Code Archive'</span>))
<span class="keyword">for</span> ChinIND=1:length(Chins2Run)
    <span class="keyword">for</span> CondIND=1:length(Conds2Run)
        filepath = strcat(OUTdir,filesep,EXPname,filesep,Chins2Run{ChinIND},filesep,Conds2Run{CondIND});
        datapath = strcat(DATAdir,filesep,Chins2Run{ChinIND},filesep,EXPname,filesep,Conds2Run{CondIND});
        calibpath = datapath;
        filepath_files{ChinIND,CondIND} = search_files(filepath,filepath_searchfile).files;  <span class="comment">% analyzed raw data files available</span>
        datapath_files{ChinIND,CondIND} = search_files(datapath,datapath_searchfile).files; <span class="comment">% raw data files available</span>
        filepath_dir_temp{ChinIND,CondIND} = search_files(filepath,filepath_searchfile).dir;  <span class="comment">% analyzed raw data files available</span>
        datapath_dir_temp{ChinIND,CondIND} = search_files(datapath,datapath_searchfile).dir; <span class="comment">% raw data files available</span>
        <span class="keyword">if</span> ~isempty(filepath_files{ChinIND,CondIND})
            filepath_idx(ChinIND,CondIND) = 1;
        <span class="keyword">end</span>
        <span class="keyword">if</span> ~isempty(datapath_files{ChinIND,CondIND})
            datapath_idx(ChinIND,CondIND) = 1;
        <span class="keyword">end</span>
        <span class="keyword">if</span> strcmp(chinroster.signal(ChinIND,CondIND),<span class="string">'X'</span>) || strcmp(chinroster.signal(ChinIND,CondIND),<span class="string">'x'</span>)
            subject_idx(ChinIND,CondIND) = 1;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="comment">% Remove subjects if baseline is not present for relative to</span>
<span class="keyword">if</span> idx_plot_relative == 1
    chins_idx = find(subject_idx(:,idx_plot_relative) == 0);
    Chins2Run(chins_idx) = [];
    chinroster.ChinSex(chins_idx,:) = [];
    chinroster.signal(chins_idx, :) = [];
    subject_idx(chins_idx, :) = [];
    datapath_idx(chins_idx, :) = [];
    filepath_idx(chins_idx, :) = [];
    filepath_dir_temp(chins_idx, :) = [];
    datapath_dir_temp(chins_idx, :) = [];
<span class="keyword">end</span>
<span class="comment">% Remove timepoints that are not present</span>
filepath_dir = cell(size(filepath_dir_temp));
datapath_dir = cell(size(datapath_dir_temp));
filepath_dir(filepath_idx==1) = filepath_dir_temp(filepath_idx==1);
datapath_dir(datapath_idx==1) = datapath_dir_temp(datapath_idx==1);
define_global_vars(Chins2Run,all_Conds2Run,EXPname,EXPname2);
<span class="keyword">for</span> ChinIND=1:length(Chins2Run)
    conds_idx = find(subject_idx(ChinIND,:)==1);
    Conds2Run = all_Conds2Run(conds_idx);
    <span class="keyword">for</span> i=1:length(conds_idx)
        CondIND = conds_idx(i);
        file_check = filepath_idx(ChinIND,CondIND);
        data_check = datapath_idx(ChinIND,CondIND);
        subject_check = subject_idx(ChinIND,CondIND);
        condition = strsplit(all_Conds2Run{CondIND}, filesep);
        cd(CODEdir);
        <span class="keyword">if</span> file_check == 0 &amp;&amp; data_check == 1 &amp;&amp; subject_check == 1 || reanalyze == 1  <span class="comment">% convert RAW data for analysis for no existing analyzed file</span>
            fprintf(<span class="string">'\nSubject: %s (%s)\n'</span>,Chins2Run{ChinIND},all_Conds2Run{CondIND});
            filepath = strcat(OUTdir,filesep,EXPname,filesep,Chins2Run{ChinIND},filesep,all_Conds2Run{CondIND});
            datapath = datapath_dir{ChinIND,CondIND};
            calibpath = datapath;
            <span class="keyword">if</span> ~exist(filepath, <span class="string">'dir'</span>)
                fprintf(<span class="string">'\nCreating analysis directory for %s (%s)...\n'</span>,Chins2Run{ChinIND},all_Conds2Run{CondIND});
                mkdir(filepath);
            <span class="keyword">end</span>
            <span class="keyword">switch</span> EXPname
                <span class="keyword">case</span> <span class="string">'ABR'</span>
                    <span class="keyword">switch</span> EXPname2
                        <span class="keyword">case</span> <span class="string">'Thresholds'</span>
                            abr_out = ABR_audiogram_chin(datapath,filepath,Chins2Run{ChinIND},Conds2Run,CondIND);
                        <span class="keyword">case</span> <span class="string">'Peaks'</span>
                            <span class="keyword">switch</span> EXPname3
                                <span class="keyword">case</span> <span class="string">'Manual'</span>
                                    abr_peaks_setup(ROOTdir,datapath,filepath,Chins2Run{ChinIND},condition{2})
                                <span class="keyword">case</span> <span class="string">'DTW'</span>
                                    <span class="comment">%filepath = strcat(OUTdir,filesep,EXPname,filesep,EXPname3,filesep,condition{2});</span>
                                    <span class="comment">%if ~exist(filepath,'dir'), mkdir(filepath), end</span>
                                    processClick_dtw(datapath,filepath,Chins2Run,ChinIND,Conds2Run,CondIND,colors,shapes)
                            <span class="keyword">end</span>
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'EFR'</span>
                    <span class="keyword">switch</span> EXPname2
                        <span class="keyword">case</span> <span class="string">'AM/FM'</span>
</pre><h2 id="6">TBD</h2><pre class="codeinput">                        <span class="keyword">case</span> <span class="string">'RAM'</span>
                            EFRanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                            cd(CODEdir)
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'OAE'</span>
                    <span class="keyword">switch</span> EXPname2
                        <span class="keyword">case</span> <span class="string">'DPOAE'</span>
                            DPanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                        <span class="keyword">case</span> <span class="string">'SFOAE'</span>
                            SFanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                        <span class="keyword">case</span> <span class="string">'TEOAE'</span>
                            TEanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'MEMR'</span>
                    WBMEMRanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
            <span class="keyword">end</span>
        <span class="keyword">elseif</span> data_check == 0 &amp;&amp; subject_check == 1   <span class="comment">% move files from Data/RAW directory into individual folder</span>
            datapath = strcat(DATAdir,filesep,Chins2Run{ChinIND},filesep,EXPname,filesep,all_Conds2Run{CondIND});
            <span class="keyword">if</span> ~exist(datapath, <span class="string">'dir'</span>)
                fprintf(<span class="string">'\nCreating analysis directory for %s (%s)...\n'</span>,Chins2Run{ChinIND},all_Conds2Run{CondIND});
                mkdir(datapath);
            <span class="keyword">end</span>
            cd(CODEdir)
            <span class="keyword">if</span> ismac
                <span class="comment">%sourcepath = '/Volumes/heinz/data/UserTESTS/FA/DOD/Data/RAW';  % data depot</span>
                sourcepath = <span class="string">'/Volumes/FefeSSD/DOD/Data/RAW'</span>;
            <span class="keyword">else</span>
                <span class="comment">%sourcepath = 'Z:\data\UserTESTS\FA\DOD\Data\RAW';   % data depot</span>
                sourcepath = <span class="string">'D:\DOD\Data\RAW'</span>; <span class="comment">% SSD</span>
            <span class="keyword">end</span>
            move_files(Chins2Run,all_Conds2Run,ChinIND,CondIND,sourcepath,EXPname,DATAdir,CODEdir);
        <span class="keyword">elseif</span> file_check == 1 &amp;&amp; data_check == 1 &amp;&amp; subject_check == 1 || flag == 1
            counter = counter+1;
            <span class="keyword">if</span> counter == sum(sum(subject_idx))
                flag = 1;
            <span class="keyword">end</span>
            fprintf(<span class="string">'\nLoading Data for Averaging...\nSubject: %s (%s)\n'</span>,Chins2Run{ChinIND},all_Conds2Run{CondIND});
            filepath = filepath_dir{ChinIND,CondIND};
            datapath = datapath_dir{ChinIND,CondIND};
            <span class="keyword">switch</span> EXPname
                <span class="keyword">case</span> <span class="string">'ABR'</span>
                    cd(strcat(ROOTdir,filesep,<span class="string">'Code Archive'</span>,filesep,<span class="string">'ABR'</span>));
                    <span class="keyword">switch</span> EXPname2
                        <span class="keyword">case</span> <span class="string">'Thresholds'</span>
                            ABRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_abr_threshold,[],[],ylimits_avg_abr_threshold,[],[],colors,shapes,EXPname2,EXPname3,flag,conds_idx);                        <span class="keyword">case</span> <span class="string">'Peaks'</span>
                            <span class="keyword">switch</span> EXPname3
                                <span class="keyword">case</span> <span class="string">'Manual'</span>
                                    ABRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,[],ylimits_ind_abr_peaks,ylimits_ind_abr_lat,[],ylimits_avg_abr_peaks,ylimits_avg_abr_lat,colors,shapes,EXPname2,EXPname3,flag,conds_idx);
                                <span class="keyword">case</span> <span class="string">'DTW'</span>
                                    <span class="comment">%filepath = strcat(OUTdir,filesep,EXPname,filesep,EXPname3,filesep,condition{2});</span>
                                    ABRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,[],ylimits_ind_abr_peaks,ylimits_ind_abr_lat,[],ylimits_avg_abr_peaks,ylimits_avg_abr_lat,colors,shapes,EXPname2,EXPname3,flag,conds_idx);
                            <span class="keyword">end</span>
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'EFR'</span>
                    cd(CODEdir)
                    EFRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,ylimits_efr,idx_plot_relative,efr_level,shapes,colors,flag,subject_idx,conds_idx);
                <span class="keyword">case</span> <span class="string">'OAE'</span>
                    cd(CODEdir)
                    <span class="keyword">switch</span> EXPname2
                        <span class="keyword">case</span> <span class="string">'DPOAE'</span>
                            DPsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_oae,ylimits_avg_oae,shapes,colors,flag,conds_idx);
                        <span class="keyword">case</span> <span class="string">'SFOAE'</span>
                            SFSummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_oae,ylimits_avg_oae,shapes,colors,flag,conds_idx);
                        <span class="keyword">case</span> <span class="string">'TEOAE'</span>
                            TEsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_oae,ylimits_avg_oae,shapes,colors,flag,conds_idx);
                    <span class="keyword">end</span>
                <span class="keyword">case</span> <span class="string">'MEMR'</span>
                    cd(CODEdir)
                    WBMEMRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,xlimits_memr,shapes,colors,flag,conds_idx)
            <span class="keyword">end</span>
            flag = -1;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
cd(cwd);
</pre><pre class="codeoutput">
ROOT directory exists.
DATA directory exists.
OUT directory exists.
CODE directory exists.All directories loaded succesfully:
ROOT:	 D:\DOD
DATA:	 D:\DOD\Data
OUT:	 D:\DOD\Analysis
CODE:	 D:\DOD\Code Archive\ABR\Thresholds

Loading Data for Averaging...
Subject: Q438 (pre\Baseline)
File: Q438_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q438 (post\D7)
File: Q438_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q438 (post\D14)
File: Q438_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q445 (pre\Baseline)
File: Q445_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q445 (post\D7)
File: Q445_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q445 (post\D14)
File: Q445_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q446 (pre\Baseline)
File: Q446_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q446 (post\D7)
File: Q446_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q446 (post\D14)
File: Q446_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q447 (pre\Baseline)
File: Q447_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q447 (post\D7)
File: Q447_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q447 (post\D14)
File: Q447_postD14_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q447 (post\D30)
File: Q447_postD30_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D30
 

Loading Data for Averaging...
Subject: Q460 (pre\Baseline)
File: Q460_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q460 (post\D7)
File: Q460_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q460 (post\D14)
File: Q460_postD14_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q460 (post\D30)
File: Q460_postD30_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D30
 

Loading Data for Averaging...
Subject: Q461 (pre\Baseline)
File: Q461_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q461 (post\D7)
File: Q461_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q461 (post\D14)
File: Q461_postD14_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q461 (post\D30)
File: Q461_postD30_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D30
 

Loading Data for Averaging...
Subject: Q462 (pre\Baseline)
File: Q462_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q462 (post\D7)
File: Q462_postD7_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q464 (pre\Baseline)
File: Q464_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q464 (post\D7)
File: Q464_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q464 (post\D14)
File: Q464_postD14_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q464 (post\D30)
File: Q464_postD30_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D30
 

Loading Data for Averaging...
Subject: Q473 (pre\Baseline)
File: Q473_preBaseline_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q474 (pre\Baseline)
File: Q474_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q474 (post\D7)
File: Q474_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q474 (post\D14)
File: Q474_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q475 (pre\Baseline)
File: Q475_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q475 (post\D7)
File: Q475_postD7_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q476 (pre\Baseline)
File: Q476_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q476 (post\D7)
File: Q476_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q476 (post\D14)
File: Q476_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q479 (pre\Baseline)
File: Q479_preBaseline_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q480 (pre\Baseline)
File: Q480_preBaseline_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q481 (pre\Baseline)
File: Q481_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q481 (post\D7)
File: Q481_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q481 (post\D14)
File: Q481_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q482 (pre\Baseline)
File: Q482_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q482 (post\D7)
File: Q482_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q482 (post\D14)
File: Q482_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q483 (pre\Baseline)
File: Q483_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q483 (post\D7)
File: Q483_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q483 (post\D14)
File: Q483_postD14_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q484 (pre\Baseline)
File: Q484_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q484 (post\D7)
File: Q484_postD7_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q485 (pre\Baseline)
File: Q485_preBaseline_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q486 (pre\Baseline)
File: Q486_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q486 (post\D7)
File: Q486_postD7_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q487 (pre\Baseline)
File: Q487_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q487 (post\D7)
File: Q487_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q487 (post\D14)
File: Q487_postD14_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q487 (post\D30)
File: Q487_postD30_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D30
 

Loading Data for Averaging...
Subject: Q488 (pre\Baseline)
File: Q488_preBaseline_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 

Loading Data for Averaging...
Subject: Q488 (post\D7)
File: Q488_postD7_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 

Loading Data for Averaging...
Subject: Q488 (post\D14)
File: Q488_postD14_ABRthresholds.mat
Warning: Ignoring extra legend entries. 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 

Loading Data for Averaging...
Subject: Q488 (post\D30)
File: Q488_postD30_ABRthresholds.mat
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
pre\Baseline
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D30
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7 (n = 18)
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7 (n = 18)
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14 (n = 14)
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D7 (n = 18)
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D14 (n = 14)
 
Warning: Error updating Legend.

 String scalar or character vector must have valid interpreter syntax:
post\D30 (n = 6)
 
</pre><img vspace="5" hspace="5" src="analysis_setup_01.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_02.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_03.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_04.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_05.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_06.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_07.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_08.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_09.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_10.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_11.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_12.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_13.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_14.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_15.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_16.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_17.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_18.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_19.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_20.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_21.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_22.png" alt=""> <img vspace="5" hspace="5" src="analysis_setup_23.png" alt=""> <h2 id="8">Analysis Summary</h2><pre class="codeinput"><span class="keyword">if</span> flag == -1
    summary_idx = zeros(length(Chins2Run),length(all_Conds2Run));
     <span class="keyword">for</span> i=1:size(summary_idx,1)
        <span class="keyword">for</span> j=1:size(summary_idx,2)
            <span class="keyword">if</span> filepath_idx(i,j) == 1 &amp;&amp; subject_idx(i,j) == 1
                summary_idx(i,j) = 1;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
     <span class="keyword">end</span>
    summary = cell(length(Chins2Run),length(all_Conds2Run)+1);
    <span class="keyword">for</span> i=1:size(summary,1)
        <span class="keyword">for</span> j=2:size(summary,2)
            <span class="keyword">if</span> summary_idx(i,j-1) == 1
                summary(i,j) = all_Conds2Run(j-1);
            <span class="keyword">end</span>
            <span class="keyword">if</span> j==2
                summary(i,j-1) = Chins2Run(i);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="comment">% Output</span>
    fprintf(<span class="string">'\nANALYSIS SUMMARY:\n'</span>);
    fprintf(<span class="string">'\nSubject'</span>);
    <span class="keyword">for</span> j=1:length(all_Conds2Run)
        fprintf(<span class="string">' \t%s'</span>,all_Conds2Run{j});
    <span class="keyword">end</span>
    <span class="keyword">for</span> i=1:size(summary,1)
        fprintf(<span class="string">'\n %s\t'</span>,summary{i,1});
        <span class="keyword">for</span> j=2:size(summary,2)
            <span class="keyword">if</span> ~isempty(summary{i,j})
                fprintf(<span class="string">' \t%s\t'</span>,<span class="string">'YES'</span>);
            <span class="keyword">else</span>
                fprintf(<span class="string">' \t%s\t'</span>,<span class="string">'NO'</span>);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><pre class="codeoutput">
ANALYSIS SUMMARY:

Subject 	pre\Baseline 	post\D7 	post\D14 	post\D30
 Q438	 	YES	 	YES	 	YES	 	NO	
 Q445	 	YES	 	YES	 	YES	 	NO	
 Q446	 	YES	 	YES	 	YES	 	NO	
 Q447	 	YES	 	YES	 	YES	 	YES	
 Q460	 	YES	 	YES	 	YES	 	YES	
 Q461	 	YES	 	YES	 	YES	 	YES	
 Q462	 	YES	 	YES	 	NO	 	NO	
 Q464	 	YES	 	YES	 	YES	 	YES	
 Q473	 	YES	 	NO	 	NO	 	NO	
 Q474	 	YES	 	YES	 	YES	 	NO	
 Q475	 	YES	 	YES	 	NO	 	NO	
 Q476	 	YES	 	YES	 	YES	 	NO	
 Q479	 	YES	 	NO	 	NO	 	NO	
 Q480	 	YES	 	NO	 	NO	 	NO	
 Q481	 	YES	 	YES	 	YES	 	NO	
 Q482	 	YES	 	YES	 	YES	 	NO	
 Q483	 	YES	 	YES	 	YES	 	NO	
 Q484	 	YES	 	YES	 	NO	 	NO	
 Q485	 	YES	 	NO	 	NO	 	NO	
 Q486	 	YES	 	YES	 	NO	 	NO	
 Q487	 	YES	 	YES	 	YES	 	YES	
 Q488	 	YES	 	YES	 	YES	 	YES	</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
clc; close all; clear all;
exposure_group = 'NOISE'; % 'NOISE' or 'BLAST'
plot_relative_flag = 1;   % Relative to Baseline:  Yes = 1   or  No = 0
reanalyze = 0; % 1 = redo analysis      0 = skip analysis
efr_level = 65; % EFR Levels = 65 or 80 dB SPL
shapes = ["o";"square";"diamond";"^";"v";">";"pentagram"];
colors = [0,114,189; 237,177,32; 126,47,142; 119,172,48; 204,0,0; 255,51,255; 217 83 25]/255;
%% Plot limits
ylimits_avg_oae = [-60,60];
ylimits_ind_oae = [-60,60];
xlimits_memr = [70,105];
ylimits_efr = [0,1.3];
ylimits_ind_abr_threshold = [0,80];
ylimits_avg_abr_threshold = [-10,50];
ylimits_ind_abr_peaks = [0,inf];
ylimits_avg_abr_peaks = [-inf,inf];
ylimits_ind_abr_lat = [-inf,inf];
ylimits_avg_abr_lat = [-inf,inf];
%% ROOT Directory
if ismac
    %ROOTdir = '/Volumes/heinz/data/UserTESTS/FA/DOD';  % data depot
    ROOTdir = '/Volumes/FefeSSD/DOD';
else
    %ROOTdir = 'Z:\data\UserTESTS\FA\DOD'; % data depot
    ROOTdir = 'D:\DOD'; % SSD
    %ROOTdir = 'F:\DOD'; % NEL2
end
%% Subjects and Conditions
if strcmp(exposure_group,'BLAST')
    Conds2Run = {strcat('pre',filesep,'Baseline'),strcat('post',filesep,'D3'),strcat('post',filesep,'D15'),strcat('post',filesep,'D43'),strcat('post',filesep,'D92'),strcat('post',filesep,'D107'),strcat('post',filesep,'D120')};
    Chins2Run={'Q493','Q494'};
    % BLAST: 'Q457','Q463','Q478','Q493','Q494'
    % 75 kPa: 'Q457','Q478','Q493'
    % 150 kPa: 'Q463','Q494'
elseif strcmp(exposure_group,'NOISE')
    Conds2Run = {strcat('pre',filesep,'Baseline'),strcat('post',filesep,'D7'),strcat('post',filesep,'D14'),strcat('post',filesep,'D30')};
    Chins2Run={'Q438','Q445','Q446','Q447','Q460','Q461','Q462','Q464','Q473','Q474','Q475','Q476','Q479','Q480','Q481','Q482','Q483','Q484','Q485','Q486','Q487','Q488'};
    % ALL: 'Q438','Q445','Q446','Q447','Q460','Q461','Q462','Q464','Q473','Q474','Q475','Q476','Q479','Q480','Q481','Q482','Q483','Q484','Q485','Q486','Q487','Q488'
    % Group 1: 'Q438','Q445','Q446','Q447' (8hrs/5 days per week)
    % Group 2: 'Q460','Q461','Q462','Q464' (10hrs/4 days per week)
    % Group 3: 'Q473','Q474','Q475','Q476','Q479','Q480' (10hrs/4 days per week)
    % Group 4: 'Q481','Q482','Q483','Q484','Q487','Q488' (10hrs/4 days per week)
    % Group 5: 'Q485','Q486' (10hrs/4 days per week)
    % GROUP 6: 'Q499','Q500','Q503','Q504','Q505' (NAIVE)
end
if plot_relative_flag == 1
    plot_relative = {strcat('pre',filesep,'Baseline')};
else
    plot_relative = {};
end
%% Analysis Code
cwd = pwd;
if ~isempty(plot_relative)
    idx_plot_relative = ismember(plot_relative,Conds2Run);
else
    idx_plot_relative = [];
end
[EXPname, EXPname2, EXPname3] = analysis_menu;
[DATAdir, OUTdir, CODEdir] = get_directory(ROOTdir,EXPname,EXPname2);
addpath(CODEdir);
if strcmp(EXPname,'OAE')
    filepath_searchfile = ['*',EXPname2,'*.mat'];
    datapath_searchfile = filepath_searchfile;
elseif strcmp(EXPname,'ABR')
    datapath_searchfile = '*ABR*.mat';
    switch EXPname2
        case 'Thresholds'
            filepath_searchfile = ['*',EXPname,'thresholds*.mat'];
        case 'Peaks'
            switch EXPname3
                case 'Manual'
                    filepath_searchfile = ['*',EXPname,'peaks*.mat'];
                case 'DTW'
                    filepath_searchfile = ['*',EXPname,'peaks_dtw*.mat'];
            end
    end
elseif strcmp(EXPname,'EFR')
    filepath_searchfile = '*EFR*.mat';
    datapath_searchfile = '*FFR*.mat';
else
    filepath_searchfile = ['*',EXPname,'*.mat'];
    datapath_searchfile = filepath_searchfile;
end
% Check available subjects and conditions
chinroster_file = 'DOD_ChinRoster.xlsx';
if ~isempty(search_files(OUTdir,chinroster_file).files)
    cd(OUTdir)
    chinroster_temp = readcell(chinroster_file,'Sheet',exposure_group);
    temp_idx = cellfun(@(x) any(isa(x,'missing')), chinroster_temp);
    chinroster_temp(temp_idx) = {NaN};
    [temp_rows,temp_cols] = size(chinroster_temp);
    temp = zeros(1,temp_rows);
    % Define rows for subjects to include
    for i=1:temp_rows
        for j=1:length(Chins2Run)
            if strcmp(chinroster_temp(i,1),Chins2Run{j})
                temp(i) = 1;
            end
        end
    end
    % Define cols for conditions to include
    col_idx = zeros(1,temp_cols);
    for i=1:temp_rows
        for j=1:temp_cols
            if strcmp(chinroster_temp(i,j),'Baseline') || strcmp(chinroster_temp(i,j),'B')
                col_idx(j) = 1;
                row_idx = i;
            end
        end
    end
    col_idx = find(col_idx == 1);
    conds_length = col_idx(2)-col_idx(1)-1;
    all_temp = chinroster_temp(row_idx,col_idx(1):col_idx(1)+conds_length);
    for i=1:length(all_temp)
        if strcmp(all_temp{i},'Baseline') || strcmp(all_temp{i},'B')
            all_Conds2Run{i} = strcat('pre',filesep,all_temp{i});
        else
            all_Conds2Run{i} = strcat('post',filesep,all_temp{i});
        end
    end
    chins_idx = find(temp==1);
    conds_idx = zeros(size(all_Conds2Run));
    for i=1:length(all_Conds2Run)
        conds_idx(i) = find(strcmp(Conds2Run(i),all_Conds2Run));
    end
    Chins2Run = chinroster_temp(chins_idx,1);
    chinroster.ChinSex = chinroster_temp(chins_idx,2);
    switch EXPname
        case 'ABR'
            range = col_idx(1):col_idx(1)+conds_length;
            temp = chinroster_temp(:,range);
            chinroster.signal = temp(chins_idx,conds_idx);
        case 'EFR'
            range = col_idx(2):col_idx(2)+conds_length;
            temp = chinroster_temp(:,range);
            chinroster.signal = temp(chins_idx,conds_idx);
        case 'OAE'
            switch EXPname2
                case 'DPOAE'
                    range = col_idx(3):col_idx(3)+conds_length;
                    temp = chinroster_temp(:,range);
                    chinroster.signal = temp(chins_idx,conds_idx);
                case 'SFOAE'
                    range = col_idx(4):col_idx(4)+conds_length;
                    temp = chinroster_temp(:,range);
                    chinroster.signal = temp(chins_idx,conds_idx);
                case 'TEOAE'
                    range = col_idx(5):col_idx(5)+conds_length;
                    temp = chinroster_temp(:,range);
                    chinroster.signal = temp(chins_idx,conds_idx);
            end
        case 'MEMR'
            range = col_idx(6):col_idx(6)+conds_length;
            temp = chinroster_temp(:,range);
            chinroster.signal = temp(chins_idx,conds_idx);
    end
end
% Check if RAW data has been analyzed
counter = 0;
flag = 0;
chins_idx = [];
filepath_idx = zeros(length(Chins2Run),length(Conds2Run));
datapath_idx = zeros(length(Chins2Run),length(Conds2Run));
subject_idx = zeros(length(Chins2Run),length(Conds2Run));
addpath(strcat(ROOTdir,filesep,'Code Archive'))
for ChinIND=1:length(Chins2Run)
    for CondIND=1:length(Conds2Run)
        filepath = strcat(OUTdir,filesep,EXPname,filesep,Chins2Run{ChinIND},filesep,Conds2Run{CondIND});
        datapath = strcat(DATAdir,filesep,Chins2Run{ChinIND},filesep,EXPname,filesep,Conds2Run{CondIND});
        calibpath = datapath;
        filepath_files{ChinIND,CondIND} = search_files(filepath,filepath_searchfile).files;  % analyzed raw data files available
        datapath_files{ChinIND,CondIND} = search_files(datapath,datapath_searchfile).files; % raw data files available
        filepath_dir_temp{ChinIND,CondIND} = search_files(filepath,filepath_searchfile).dir;  % analyzed raw data files available
        datapath_dir_temp{ChinIND,CondIND} = search_files(datapath,datapath_searchfile).dir; % raw data files available
        if ~isempty(filepath_files{ChinIND,CondIND})
            filepath_idx(ChinIND,CondIND) = 1;
        end
        if ~isempty(datapath_files{ChinIND,CondIND})
            datapath_idx(ChinIND,CondIND) = 1;
        end
        if strcmp(chinroster.signal(ChinIND,CondIND),'X') || strcmp(chinroster.signal(ChinIND,CondIND),'x')
            subject_idx(ChinIND,CondIND) = 1;
        end
    end
end
% Remove subjects if baseline is not present for relative to
if idx_plot_relative == 1
    chins_idx = find(subject_idx(:,idx_plot_relative) == 0);
    Chins2Run(chins_idx) = [];
    chinroster.ChinSex(chins_idx,:) = [];
    chinroster.signal(chins_idx, :) = [];
    subject_idx(chins_idx, :) = [];
    datapath_idx(chins_idx, :) = [];
    filepath_idx(chins_idx, :) = [];
    filepath_dir_temp(chins_idx, :) = [];
    datapath_dir_temp(chins_idx, :) = [];
end
% Remove timepoints that are not present
filepath_dir = cell(size(filepath_dir_temp));
datapath_dir = cell(size(datapath_dir_temp));
filepath_dir(filepath_idx==1) = filepath_dir_temp(filepath_idx==1);
datapath_dir(datapath_idx==1) = datapath_dir_temp(datapath_idx==1);
define_global_vars(Chins2Run,all_Conds2Run,EXPname,EXPname2);
for ChinIND=1:length(Chins2Run)
    conds_idx = find(subject_idx(ChinIND,:)==1);
    Conds2Run = all_Conds2Run(conds_idx);
    for i=1:length(conds_idx)
        CondIND = conds_idx(i);
        file_check = filepath_idx(ChinIND,CondIND);
        data_check = datapath_idx(ChinIND,CondIND);
        subject_check = subject_idx(ChinIND,CondIND);
        condition = strsplit(all_Conds2Run{CondIND}, filesep);
        cd(CODEdir);
        if file_check == 0 && data_check == 1 && subject_check == 1 || reanalyze == 1  % convert RAW data for analysis for no existing analyzed file
            fprintf('\nSubject: %s (%s)\n',Chins2Run{ChinIND},all_Conds2Run{CondIND});
            filepath = strcat(OUTdir,filesep,EXPname,filesep,Chins2Run{ChinIND},filesep,all_Conds2Run{CondIND});
            datapath = datapath_dir{ChinIND,CondIND};
            calibpath = datapath;
            if ~exist(filepath, 'dir')
                fprintf('\nCreating analysis directory for %s (%s)...\n',Chins2Run{ChinIND},all_Conds2Run{CondIND});
                mkdir(filepath);
            end
            switch EXPname
                case 'ABR'
                    switch EXPname2
                        case 'Thresholds'
                            abr_out = ABR_audiogram_chin(datapath,filepath,Chins2Run{ChinIND},Conds2Run,CondIND);
                        case 'Peaks'
                            switch EXPname3
                                case 'Manual'
                                    abr_peaks_setup(ROOTdir,datapath,filepath,Chins2Run{ChinIND},condition{2})
                                case 'DTW'
                                    %filepath = strcat(OUTdir,filesep,EXPname,filesep,EXPname3,filesep,condition{2});
                                    %if ~exist(filepath,'dir'), mkdir(filepath), end
                                    processClick_dtw(datapath,filepath,Chins2Run,ChinIND,Conds2Run,CondIND,colors,shapes)
                            end
                    end
                case 'EFR'
                    switch EXPname2
                        case 'AM/FM'
                            %% TBD
                        case 'RAM'
                            EFRanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                            cd(CODEdir)
                    end
                case 'OAE'
                    switch EXPname2
                        case 'DPOAE'
                            DPanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                        case 'SFOAE'
                            SFanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                        case 'TEOAE'
                            TEanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
                    end
                case 'MEMR'
                    WBMEMRanalysis(datapath,filepath,Chins2Run{ChinIND},condition{2});
            end
        elseif data_check == 0 && subject_check == 1   % move files from Data/RAW directory into individual folder
            datapath = strcat(DATAdir,filesep,Chins2Run{ChinIND},filesep,EXPname,filesep,all_Conds2Run{CondIND});
            if ~exist(datapath, 'dir')
                fprintf('\nCreating analysis directory for %s (%s)...\n',Chins2Run{ChinIND},all_Conds2Run{CondIND});
                mkdir(datapath);
            end
            cd(CODEdir)
            if ismac
                %sourcepath = '/Volumes/heinz/data/UserTESTS/FA/DOD/Data/RAW';  % data depot
                sourcepath = '/Volumes/FefeSSD/DOD/Data/RAW';
            else
                %sourcepath = 'Z:\data\UserTESTS\FA\DOD\Data\RAW';   % data depot
                sourcepath = 'D:\DOD\Data\RAW'; % SSD
            end
            move_files(Chins2Run,all_Conds2Run,ChinIND,CondIND,sourcepath,EXPname,DATAdir,CODEdir);
        elseif file_check == 1 && data_check == 1 && subject_check == 1 || flag == 1
            counter = counter+1;
            if counter == sum(sum(subject_idx))
                flag = 1;
            end
            fprintf('\nLoading Data for Averaging...\nSubject: %s (%s)\n',Chins2Run{ChinIND},all_Conds2Run{CondIND});
            filepath = filepath_dir{ChinIND,CondIND};
            datapath = datapath_dir{ChinIND,CondIND};
            switch EXPname
                case 'ABR'
                    cd(strcat(ROOTdir,filesep,'Code Archive',filesep,'ABR'));
                    switch EXPname2
                        case 'Thresholds'
                            ABRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_abr_threshold,[],[],ylimits_avg_abr_threshold,[],[],colors,shapes,EXPname2,EXPname3,flag,conds_idx);                        case 'Peaks'
                            switch EXPname3
                                case 'Manual'
                                    ABRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,[],ylimits_ind_abr_peaks,ylimits_ind_abr_lat,[],ylimits_avg_abr_peaks,ylimits_avg_abr_lat,colors,shapes,EXPname2,EXPname3,flag,conds_idx);
                                case 'DTW'
                                    %filepath = strcat(OUTdir,filesep,EXPname,filesep,EXPname3,filesep,condition{2});
                                    ABRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,[],ylimits_ind_abr_peaks,ylimits_ind_abr_lat,[],ylimits_avg_abr_peaks,ylimits_avg_abr_lat,colors,shapes,EXPname2,EXPname3,flag,conds_idx);
                            end
                    end
                case 'EFR'
                    cd(CODEdir)
                    EFRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,ylimits_efr,idx_plot_relative,efr_level,shapes,colors,flag,subject_idx,conds_idx);
                case 'OAE'
                    cd(CODEdir)
                    switch EXPname2
                        case 'DPOAE'
                            DPsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_oae,ylimits_avg_oae,shapes,colors,flag,conds_idx);
                        case 'SFOAE'
                            SFSummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_oae,ylimits_avg_oae,shapes,colors,flag,conds_idx);
                        case 'TEOAE'
                            TEsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,ylimits_ind_oae,ylimits_avg_oae,shapes,colors,flag,conds_idx);
                    end
                case 'MEMR'
                    cd(CODEdir)
                    WBMEMRsummary(filepath,OUTdir,Conds2Run,Chins2Run,all_Conds2Run,ChinIND,CondIND,idx_plot_relative,xlimits_memr,shapes,colors,flag,conds_idx)
            end
            flag = -1;
        end
    end
end
cd(cwd);
%% Analysis Summary
if flag == -1
    summary_idx = zeros(length(Chins2Run),length(all_Conds2Run));
     for i=1:size(summary_idx,1)
        for j=1:size(summary_idx,2)
            if filepath_idx(i,j) == 1 && subject_idx(i,j) == 1
                summary_idx(i,j) = 1;
            end
        end
     end
    summary = cell(length(Chins2Run),length(all_Conds2Run)+1);
    for i=1:size(summary,1)
        for j=2:size(summary,2)
            if summary_idx(i,j-1) == 1
                summary(i,j) = all_Conds2Run(j-1);
            end
            if j==2
                summary(i,j-1) = Chins2Run(i);
            end
        end
    end
    % Output
    fprintf('\nANALYSIS SUMMARY:\n');
    fprintf('\nSubject');
    for j=1:length(all_Conds2Run)
        fprintf(' \t%s',all_Conds2Run{j});
    end
    for i=1:size(summary,1)
        fprintf('\n %s\t',summary{i,1});
        for j=2:size(summary,2)
            if ~isempty(summary{i,j})
                fprintf(' \t%s\t','YES');
            else
                fprintf(' \t%s\t','NO');
            end
        end
    end
end
##### SOURCE END #####
--></body></html>